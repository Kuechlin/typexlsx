var L=Object.defineProperty,V=Object.defineProperties;var P=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,H=Object.prototype.propertyIsEnumerable;var u=(n,e,t)=>e in n?L(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,S=(n,e)=>{for(var t in e||(e={}))G.call(e,t)&&u(n,t,e[t]);if(b)for(var t of b(e))H.call(e,t)&&u(n,t,e[t]);return n},k=(n,e)=>V(n,P(e));var a=(n,e,t)=>(u(n,typeof e!="symbol"?e+"":e,t),t);import{J as U,F as v}from"./vendor.27b2d947.js";const j=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function t(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerpolicy&&(o.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?o.credentials="include":r.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=t(r);fetch(r.href,o)}};j();const h=(...n)=>({version:"1.0",encoding:"utf-8",standalone:"yes",$elements:n}),i=(n,e,...t)=>k(S({},e),{$type:"element",$name:n,$elements:t}),T=n=>({$type:"value",$value:String(n)}),w=n=>{let e="";for(const t in n)!t.startsWith("$")&&n[t]!==null&&n[t]!==void 0&&(e+=` ${t}="${String(n[t])}"`);return e},I=n=>{if(n.$type==="value")return n.$value;let e=`<${n.$name}${w(n)}`;if(n.$elements){e+=">";for(const t of n.$elements)e+=I(t);e+=`</${n.$name}>`}else e+="/>";return e};var X={stringify(n){let e=`<?xml${w(n)}?>`;for(const t of n.$elements)e+=I(t);return e}},f;(function(n){n.Workbook="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",n.Worksheets="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",n.Styles="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",n.SharedStrings="application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"})(f||(f={}));function z(...n){return h(i("Types",{xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"},i("Default",{Extension:"xml",ContentType:"application/xml"}),i("Default",{Extension:"rels",ContentType:"application/vnd.openxmlformats-package.relationships+xml"}),...n.map(e=>i("Override",{PartName:e.path.startsWith("/")?e.path:"/"+e.path,ContentType:e.contentType.toString()}))))}var p;(function(n){n.Workbook="http://purl.oclc.org/ooxml/officeDocument/relationships/officeDocument",n.Worksheet="http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet",n.Styles="http://purl.oclc.org/ooxml/officeDocument/relationships/styles",n.SharedStrings="http://purl.oclc.org/ooxml/officeDocument/relationships/sharedStrings"})(p||(p={}));function $(...n){return h(i("Relationships",{xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"},...n.map(({id:e,type:t,target:s})=>i("Relationship",{Id:"rId"+e,Type:t.toString(),Target:s}))))}const Y={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mx":"http://schemas.microsoft.com/office/mac/excel/2008/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","xmlns:mv":"urn:schemas-microsoft-com:mac:vml","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac","xmlns:xm":"http://schemas.microsoft.com/office/excel/2006/main"},q={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","xmlns:mv":"urn:schemas-microsoft-com:mac:vml","xmlns:mx":"http://schemas.microsoft.com/office/mac/excel/2008/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac","xmlns:xm":"http://schemas.microsoft.com/office/excel/2006/main"};function J(n){return n.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;")}class Z{constructor(){a(this,"sharedStrings",[]);a(this,"create",e=>{e=J(e);let t=this.sharedStrings.indexOf(e);return t===-1&&(t=this.sharedStrings.push(e)-1),t});a(this,"generate",()=>h(i("sst",{xmlns:"http://purl.oclc.org/ooxml/spreadsheetml/main",count:this.sharedStrings.length,uniqueCount:this.sharedStrings.length},...this.sharedStrings.map(e=>i("si",{},i("t",{},T(e)))))))}}const Q=n=>typeof n=="object"&&("color"in n||"style"in n);function x(n){if(n[0]!=="#")throw new Error(`Color "${n}" must start with a "#"`);return`FF${n.slice("#".length).toUpperCase()}`}class ee{constructor(){a(this,"borders",[]);a(this,"bordersIndex",new Map);a(this,"getBorderKey",e=>e?`${e.color}/${e.style}`:"-");a(this,"getBordersKey",({start:e,bottom:t,diagonal:s,end:r,top:o})=>[e,r,o,t,s].map(this.getBorderKey).join("/"));a(this,"getBorderElement",(e,t)=>{let s=t==null?void 0:t.style;return(t==null?void 0:t.color)&&!s&&(s="thin"),i(e,s?{style:s}:{},...(t==null?void 0:t.color)?[i("color",{rgb:x(t.color)})]:[])});a(this,"getBorder",e=>{if(!e)return 0;var t;Q(e)?t={start:e,end:e,top:e,bottom:e}:t=e;const s=this.getBordersKey(t);return this.bordersIndex.has(s)||this.bordersIndex.set(s,this.borders.push(t)-1),this.bordersIndex.get(s)});a(this,"generate",()=>i("borders",{count:this.borders.length},...this.borders.map(({start:e,end:t,top:s,bottom:r,diagonal:o})=>i("border",{},this.getBorderElement("start",e),this.getBorderElement("end",t),this.getBorderElement("top",s),this.getBorderElement("bottom",r),this.getBorderElement("diagonal",o)))));this.borders.push({}),this.bordersIndex.set(this.getBorderKey({}),0)}}class te{constructor(){a(this,"fills",[{},{gray125:!0}]);a(this,"fillsIndex",new Map);a(this,"getFill",e=>e?(e&&!this.fillsIndex.has(e)&&this.fillsIndex.set(e,this.fills.push(e)-1),this.fillsIndex.get(e)):0);a(this,"generate",()=>i("fills",{count:this.fills.length},...this.fills.map(e=>{let t;return typeof e=="string"?t=i("patternFill",{patternType:"solid"},i("fgColor",{rgb:x(e)}),i("bgColor",{indexed:64})):typeof e=="object"&&"gray125"in e&&e.gray125?t=i("patternFill",{patternType:"gray125"}):t=i("patternFill",{patternType:"none"}),i("fill",{},t)})))}}const C="Calibri",F=12,E={bold:i("b"),italic:i("i")};class ne{constructor(){a(this,"fonts",[]);a(this,"fontsIndex",new Map);a(this,"getFontKey",({family:e=C,size:t=F,style:s="none",color:r="-"})=>`${e}/${t}/${s}/${r}`);a(this,"getFont",e=>{if(!e)return 0;const t=this.getFontKey(e);return this.fontsIndex.has(t)||this.fontsIndex.set(t,this.fonts.push(e)-1),this.fontsIndex.get(t)});a(this,"generate",()=>i("fonts",{count:this.fonts.length},...this.fonts.map(({size:e,color:t,style:s,family:r})=>i("font",{},i("sz",{val:e!=null?e:F}),i("color",t?{rgb:x(t)}:{theme:1}),i("name",{val:r!=null?r:C}),i("family",{val:2}),i("scheme",{val:"minor"}),...s&&E[s]?[E[s]]:[]))));this.fontsIndex.set(this.getFontKey({}),0)}}const B=100;class re{constructor(){a(this,"formats",[]);a(this,"getFormat",e=>{if(!e)return 0;var t=this.formats.indexOf(e);return t===-1&&(t=this.formats.push(e)-1),B+t});a(this,"generate",()=>i("numFmts",{count:this.formats.length},...this.formats.map((e,t)=>i("numFmt",{numFmtId:B+t,formatCode:e}))))}}class se{constructor(){a(this,"formats",new re);a(this,"fonts",new ne);a(this,"fills",new te);a(this,"borders",new ee);a(this,"styles",[{formatId:0,fontId:0,fillId:0,borderId:0}]);a(this,"stylesIndex",new Map);a(this,"getStyleKey",({formatId:e,fontId:t,fillId:s,borderId:r,align:o="-",alignVertical:l="-",wrap:m})=>`${e}/${t}/${s}/${r}/${o}/${l}/${m?1:0}`);a(this,"generateCells",()=>i("cellXfs",{count:this.styles.length},...this.styles.map(this.generateCell)));a(this,"generateCell",e=>{const t=i("xf",{numFmtId:e.formatId,applyNumberFormat:e.formatId?1:void 0,fontId:e.fontId,applyFont:e.fontId?1:void 0,fillId:e.fillId,applyFill:e.fillId?1:void 0,borderId:e.borderId,applyBorder:e.borderId?1:void 0,applyAlignment:e.align||e.alignVertical||e.wrap?1:void 0});return(e.align||e.alignVertical||e.wrap)&&(t.$elements=[i("alignment",{horizontal:e.align,vertical:e.alignVertical,wrapText:e.wrap?1:void 0})]),t});a(this,"create",e=>{const t=this.formats.getFormat(e.format),s=this.fonts.getFont(e.font),r=this.fills.getFill(e.fill),o=this.borders.getBorder(e.border),l={formatId:t,fontId:s,fillId:r,borderId:o,align:e.align,alignVertical:e.alignVertical};var m=this.getStyleKey(l);return this.stylesIndex.has(m)||this.stylesIndex.set(m,this.styles.push(l)-1),this.stylesIndex.get(m)});a(this,"generate",()=>h(i("styleSheet",{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"},this.formats.generate(),this.fonts.generate(),this.fills.generate(),this.borders.generate(),this.generateCells())))}}const oe=70*365+19,ie=60*60*1e3,ae=24*ie;function le(n){return n.getTime()/ae+oe}function y(n,e){return`${A(n)}${e}`}const W=26;function A(n){if(typeof n!="number")return"";const e=Math.floor(n/W),t=String.fromCharCode(97+n%W).toUpperCase();return e===0?t:A(e-1)+t}class me{constructor(e){a(this,"generate",e=>{const t=this.generateMergedCells(e.rows);return h(i("worksheet",q,this.generateSheet(e.rows),...t?[t]:[]))});a(this,"generateSheet",e=>i("sheetData",{},...e.map(this.generateRow)));a(this,"generateRow",(e,t)=>{const s=t+1,r=i("row",{r:s});r.$elements=[];for(let o=0;o<e.length;o++){const l=e[o];r.$elements.push(this.generateCell(l,s,o))}return r});a(this,"generateCell",(e,t,s)=>{const r=this.workbook.styles.create(e),o=i("c",{r:y(s,t)});r!==null&&(o.s=r.toString());let l=null;if(typeof e.value=="string")o.t="s",l=this.workbook.sharedString.create(e.value);else if(typeof e.value=="boolean")o.t="s",l=e.value?1:0;else if(typeof e.value=="number")o.t="n",l=e.value;else if(e.value instanceof Date){if(!r)throw new Error('No "format" has been specified for a Date cell');o.t="n",l=le(e.value)}return l!=null&&(o.$elements=[],o.$elements.push(i("v",{},T(l)))),o});this.workbook=e}generateMergedCells(e){const t=[];for(let s=0;s<e.length;s++){const r=s+1,o=e[s];for(let l=0;l<o.length;l++){const{span:m,rowSpan:g}=o[l];if(m||g){let R=y(l,r),M=y(l+(m||0),r+(g||0));t.push(i("mergeCell",{ref:`${R}:${M}`}))}}}return t.length===0?null:i("mergeCells",{count:t.length},...t)}}class ce{constructor(){a(this,"styles");a(this,"sharedString");a(this,"worksheet");this.styles=new se,this.sharedString=new Z,this.worksheet=new me(this)}generateWorkbook(e){return h(i("workbook",Y,i("workbookPr"),i("sheets",{},...e.map((t,s)=>i("sheet",{name:t.name||`Table${s+1}`,sheetId:s+1,"r:id":`rId${s+1}`}))),i("definedNames"),i("calcPr")))}generate(e){const t={},s=[];for(let r=0;r<e.length;r++){const o=e[r],l=r+1,m=`sheet${l}.xml`,g="xl/worksheets/"+m;s.push({id:l,fileName:m,path:g}),t[g]=this.worksheet.generate(o)}return t["xl/styles.xml"]=this.styles.generate(),t["xl/sharedStrings.xml"]=this.sharedString.generate(),t["xl/workbook.xml"]=this.generateWorkbook(e),t["[Content_Types].xml"]=z(...s.map(({path:r})=>({contentType:f.Worksheets,path:r})),{contentType:f.Workbook,path:"xl/workbook.xml"},{contentType:f.SharedStrings,path:"xl/sharedStrings.xml"},{contentType:f.Styles,path:"xl/styles.xml"}),t["xl/_rels/workbook.xml.rels"]=$(...s.map(({id:r,fileName:o})=>({id:r,type:p.Worksheet,target:"worksheets/"+o})),{id:s.length+1,type:p.SharedStrings,target:"sharedStrings.xml"},{id:s.length+2,type:p.Styles,target:"styles.xml"}),t["_rels/.rels"]=$({id:1,type:p.Workbook,target:"xl/workbook.xml"}),t}}async function O(...n){const t=new ce().generate(n),s=new U;for(const[r,o]of Object.entries(t))s.file(r,X.stringify(o));return s.generateAsync({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})}const D=n=>{if(n){if(n.startsWith("#"))return n;if(n.startsWith("rgb")){var[e,t,s]=n.replace("rgb(","").replace(")","").split(",");const r=o=>(o=parseInt(o).toString(16),o.length===1?"0"+o:o);return"#"+r(e)+r(t)+r(s)}else return}else return},he={left:"left",right:"right",start:"left",end:"right",center:"center"},fe={top:"top",bottom:"bottom",middle:"center","text-top":"top","text-bottom":"bottom"},pe=(n,e)=>{const t=window.getComputedStyle(n,null),s={textAlign:he[t.getPropertyValue("text-align")],verticalAlign:fe[t.getPropertyValue("vertical-align")],color:D(t.getPropertyValue("color")),fontFamily:t.getPropertyValue("font-family").replace(/"/g,""),fontSize:parseInt(t.getPropertyValue("font-size")),backgroundColor:D(t.getPropertyValue("background-color"))},r=o=>o||void 0;return{value:n.innerText,align:r(s.textAlign),alignVertical:r(s.verticalAlign),font:{color:s.color,family:r(s.fontFamily),size:r(s.fontSize),style:n.tagName==="TH"?"bold":void 0},fill:s.backgroundColor}},ge=n=>[...n.children].filter(e=>e instanceof HTMLTableCellElement).map((e,t)=>pe(e)),N=(n,e)=>{for(const t of e)switch(t.tagName){case"THEAD":case"TBODY":N(n,t.children);break;case"TR":n.push(ge(t));break}};function de(n){const e={name:n.title,rows:[]};return N(e.rows,n.children),O(e)}const d=document.getElementById("app");if(!d)throw new Error("app not found");var ue=d.appendChild(document.createElement("h1"));ue.innerText="typexlsx";var _=d.appendChild(document.createElement("button"));_.innerText="Download XLSX";var c=d.appendChild(document.createElement("p"));const xe={name:"TestFile",rows:[[{value:"A"},{value:"B"},{value:"C",font:{family:"Arial",color:"#123456"},fill:"#fdfdfd"}],[{value:1},{value:2},{value:3}],[{value:"test",span:3,rowSpan:2},{},{}],[{},{},{}]]};_.onclick=function(){c.innerText="generating...",O(xe).then(e=>{c.innerText="saving...",v.exports.saveAs(e,"Workbook.xlsx"),c.innerText="done"}).catch(e=>c.innerText=String(e))};var K=d.appendChild(document.createElement("button"));K.innerText="Export HTML Table";K.onclick=function(){c.innerText="generating...",de(document.getElementById("table")).then(n=>{c.innerText="saving...",v.exports.saveAs(n,"Workbook.xlsx"),c.innerText="done"}).catch(n=>c.innerText=String(n))};
