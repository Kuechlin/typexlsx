var Y=Object.defineProperty,q=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var E=Object.getOwnPropertySymbols;var X=Object.prototype.hasOwnProperty,Z=Object.prototype.propertyIsEnumerable;var v=(s,e,t)=>e in s?Y(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,u=(s,e)=>{for(var t in e||(e={}))X.call(e,t)&&v(s,t,e[t]);if(E)for(var t of E(e))Z.call(e,t)&&v(s,t,e[t]);return s},S=(s,e)=>q(s,J(e));var i=(s,e,t)=>(v(s,typeof e!="symbol"?e+"":e,t),t);import{J as Q,c as b,t as ee,x as te,a as se,F as B}from"./vendor.c9263b5b.js";const ne=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerpolicy&&(a.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?a.credentials="include":o.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(o){if(o.ep)return;o.ep=!0;const a=t(o);fetch(o.href,a)}};ne();const f=(...s)=>({version:"1.0",encoding:"utf-8",standalone:"yes",$elements:s}),r=(s,e,...t)=>S(u({},e),{$type:"element",$name:s,$elements:t}),O=s=>({$type:"value",$value:String(s)}),A=s=>{let e="";for(const t in s)!t.startsWith("$")&&s[t]!==null&&s[t]!==void 0&&(e+=` ${t}="${String(s[t])}"`);return e},W=s=>{if(s.$type==="value")return s.$value;let e=`<${s.$name}${A(s)}`;if(s.$elements&&s.$elements.length){e+=">";for(const t of s.$elements)e+=W(t);e+=`</${s.$name}>`}else e+="/>";return e};var oe={stringify(s){let e=`<?xml${A(s)}?>`;for(const t of s.$elements)e+=W(t);return e}},g;(function(s){s.Workbook="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",s.Worksheets="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",s.Styles="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",s.SharedStrings="application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"})(g||(g={}));function re(...s){return f(r("Types",{xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"},r("Default",{Extension:"xml",ContentType:"application/xml"}),r("Default",{Extension:"rels",ContentType:"application/vnd.openxmlformats-package.relationships+xml"}),...s.map(e=>r("Override",{PartName:e.path.startsWith("/")?e.path:"/"+e.path,ContentType:e.contentType.toString()}))))}var p;(function(s){s.Workbook="http://purl.oclc.org/ooxml/officeDocument/relationships/officeDocument",s.Worksheet="http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet",s.Styles="http://purl.oclc.org/ooxml/officeDocument/relationships/styles",s.SharedStrings="http://purl.oclc.org/ooxml/officeDocument/relationships/sharedStrings"})(p||(p={}));function D(...s){return f(r("Relationships",{xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"},...s.map(({id:e,type:t,target:n})=>r("Relationship",{Id:"rId"+e,Type:t.toString(),Target:n}))))}const ae={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mx":"http://schemas.microsoft.com/office/mac/excel/2008/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","xmlns:mv":"urn:schemas-microsoft-com:mac:vml","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac","xmlns:xm":"http://schemas.microsoft.com/office/excel/2006/main"},ie={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","xmlns:mv":"urn:schemas-microsoft-com:mac:vml","xmlns:mx":"http://schemas.microsoft.com/office/mac/excel/2008/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac","xmlns:xm":"http://schemas.microsoft.com/office/excel/2006/main"};function le(s){return s.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;")}class ce{constructor(){i(this,"sharedStrings",[]);i(this,"create",e=>{e=le(e);let t=this.sharedStrings.indexOf(e);return t===-1&&(t=this.sharedStrings.push(e)-1),t});i(this,"generate",()=>f(r("sst",{xmlns:"http://purl.oclc.org/ooxml/spreadsheetml/main",count:this.sharedStrings.length,uniqueCount:this.sharedStrings.length},...this.sharedStrings.map(e=>r("si",{},r("t",{},O(e)))))))}}const me=s=>typeof s=="object"&&("color"in s||"style"in s);function I(s){if(s[0]!=="#")throw new Error(`Color "${s}" must start with a "#"`);return`FF${s.slice("#".length).toUpperCase()}`}class he{constructor(){i(this,"borders");i(this,"bordersIndex");i(this,"getBorderKey",e=>e?`${e.color}/${e.style}`:"-");i(this,"getBordersKey",({start:e,bottom:t,diagonal:n,end:o,top:a})=>[e,o,a,t,n].map(this.getBorderKey).join("/"));i(this,"getBorderElement",(e,t)=>{let n=t==null?void 0:t.style;return(t==null?void 0:t.color)&&!n&&(n="thin"),r(e,n?{style:n}:{},...(t==null?void 0:t.color)?[r("color",{rgb:I(t.color)})]:[])});i(this,"getBorder",e=>{if(!e)return 0;var t;me(e)?t={start:e,end:e,top:e,bottom:e}:t=e;const n=this.getBordersKey(t);return this.bordersIndex.has(n)||this.bordersIndex.set(n,this.borders.push(t)-1),this.bordersIndex.get(n)});i(this,"generate",()=>r("borders",{count:this.borders.length},...this.borders.map(({start:e,end:t,top:n,bottom:o,diagonal:a})=>r("border",{},this.getBorderElement("start",e),this.getBorderElement("end",t),this.getBorderElement("top",n),this.getBorderElement("bottom",o),this.getBorderElement("diagonal",a)))));this.borders=[{}],this.bordersIndex=new Map([[this.getBorderKey({}),0]])}}class fe{constructor(){i(this,"fills");i(this,"fillsIndex");i(this,"getFill",e=>e?(e&&!this.fillsIndex.has(e)&&this.fillsIndex.set(e,this.fills.push(e)-1),this.fillsIndex.get(e)):0);i(this,"generate",()=>r("fills",{count:this.fills.length},...this.fills.map(e=>{let t;return typeof e=="string"?t=r("patternFill",{patternType:"solid"},r("fgColor",{rgb:I(e)}),r("bgColor",{indexed:64})):typeof e=="object"&&"gray125"in e&&e.gray125?t=r("patternFill",{patternType:"gray125"}):t=r("patternFill",{patternType:"none"}),r("fill",{},t)})));this.fills=[{},{gray125:!0}],this.fillsIndex=new Map([["",0]])}}const N="Calibri",R=12,_={bold:r("b"),italic:r("i")};class ge{constructor(){i(this,"fonts");i(this,"fontsIndex");i(this,"getFontKey",({family:e=N,size:t=R,style:n="none",color:o="-"})=>`${e}/${t}/${n}/${o}`);i(this,"getFont",e=>{if(!e)return 0;const t=this.getFontKey(e);return this.fontsIndex.has(t)||this.fontsIndex.set(t,this.fonts.push(e)-1),this.fontsIndex.get(t)});i(this,"generate",()=>r("fonts",{count:this.fonts.length},...this.fonts.map(({size:e,color:t,style:n,family:o})=>r("font",{},r("sz",{val:e!=null?e:R}),r("color",t?{rgb:I(t)}:{theme:1}),r("name",{val:o!=null?o:N}),r("family",{val:2}),r("scheme",{val:"minor"}),...n&&_[n]?[_[n]]:[]))));this.fonts=[{}],this.fontsIndex=new Map([[this.getFontKey({}),0]])}}const K=100;class pe{constructor(){i(this,"formats",[]);i(this,"getFormat",e=>{if(!e)return 0;var t=this.formats.indexOf(e);return t===-1&&(t=this.formats.push(e)-1),K+t});i(this,"generate",()=>r("numFmts",{count:this.formats.length},...this.formats.map((e,t)=>r("numFmt",{numFmtId:K+t,formatCode:e}))))}}class de{constructor(){i(this,"formats",new pe);i(this,"fonts",new ge);i(this,"fills",new fe);i(this,"borders",new he);i(this,"styles",[{formatId:0,fontId:0,fillId:0,borderId:0}]);i(this,"stylesIndex",new Map);i(this,"getStyleKey",({formatId:e,fontId:t,fillId:n,borderId:o,align:a="-",alignVertical:l="-",wrap:c})=>`${e}/${t}/${n}/${o}/${a}/${l}/${c?1:0}`);i(this,"generateCells",()=>r("cellXfs",{count:this.styles.length},...this.styles.map(this.generateCell)));i(this,"generateCell",e=>{const t=r("xf",{numFmtId:e.formatId,applyNumberFormat:e.formatId?1:void 0,fontId:e.fontId,applyFont:e.fontId?1:void 0,fillId:e.fillId,applyFill:e.fillId?1:void 0,borderId:e.borderId,applyBorder:e.borderId?1:void 0,applyAlignment:e.align||e.alignVertical||e.wrap?1:void 0});return(e.align||e.alignVertical||e.wrap)&&(t.$elements=[r("alignment",{horizontal:e.align,vertical:e.alignVertical,wrapText:e.wrap?1:void 0})]),t});i(this,"create",e=>{const t=this.formats.getFormat(e.format),n=this.fonts.getFont(e.font),o=this.fills.getFill(e.fill),a=this.borders.getBorder(e.border),l={formatId:t,fontId:n,fillId:o,borderId:a,align:e.align,alignVertical:e.alignVertical,wrap:e.wrap},c=this.getStyleKey(l);return this.stylesIndex.has(c)||this.stylesIndex.set(c,this.styles.push(l)-1),this.stylesIndex.get(c)});i(this,"generate",()=>f(r("styleSheet",{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"},this.formats.generate(),this.fonts.generate(),this.fills.generate(),this.borders.generate(),this.generateCells())))}}const ue=70*365+19,xe=60*60*1e3,ye=24*xe;function Se(s){return s.getTime()/ye+ue}function $(s,e){return`${L(s)}${e}`}const V=26;function L(s){if(typeof s!="number")return"";const e=Math.floor(s/V),t=String.fromCharCode(97+s%V).toUpperCase();return e===0?t:L(e-1)+t}class T{constructor(e){i(this,"generate",e=>{const t=T.generateMergedCells(e.rows);return f(r("worksheet",ie,this.generateSheet(e.rows),...t?[t]:[]))});i(this,"generateSheet",e=>r("sheetData",{},...e.map(this.generateRow)));i(this,"generateRow",(e,t)=>{const n=t+1,o=r("row",{r:n});o.$elements=[];for(let a=0;a<e.length;a++){const l=e[a];o.$elements.push(this.generateCell(l,n,a))}return o});i(this,"generateCell",(e,t,n)=>{const o=this.workbook.styles.create(e),a=r("c",{r:$(n,t)});o!==null&&(a.s=o.toString());let l=null;if(typeof e.value=="string")a.t="s",l=this.workbook.sharedString.create(e.value);else if(typeof e.value=="boolean")a.t="s",l=e.value?1:0;else if(typeof e.value=="number")a.t="n",l=e.value;else if(e.value instanceof Date){if(!o)throw new Error('No "format" has been specified for a Date cell');a.t="n",l=Se(e.value)}return l!=null&&(a.$elements=[],a.$elements.push(r("v",{},O(l)))),a});this.workbook=e}static generateMergedCells(e){const t=[];for(let n=0;n<e.length;n++){const o=n+1,a=e[n];for(let l=0;l<a.length;l++){const{span:c,rowSpan:x}=a[l];let m=c||1,y=x||1;if((!m||m===1)&&(!y||y===1))continue;let j=$(l,o),U=$(l+m-1,o+y-1);t.push(r("mergeCell",{ref:`${j}:${U}`}));for(let h=0;h<y;h++){let C=n+h;if(e.length<=C&&e.push([]),m>1||h>0&&m>0){const H=h===0?l+1:l,z=h===0?m-1:m;e[C].splice(H,0,...new Array(z).fill({}))}}}}return t.length===0?null:r("mergeCells",{count:t.length},...t)}}class be{constructor(){i(this,"styles");i(this,"sharedString");i(this,"worksheet");this.styles=new de,this.sharedString=new ce,this.worksheet=new T(this)}generateWorkbook(e){return f(r("workbook",ae,r("workbookPr"),r("sheets",{},...e.map((t,n)=>r("sheet",{name:t.name||`Table${n+1}`,sheetId:n+1,"r:id":`rId${n+1}`}))),r("definedNames"),r("calcPr")))}generate(e){const t={},n=[];for(let o=0;o<e.length;o++){const a=e[o],l=o+1,c=`sheet${l}.xml`,x="xl/worksheets/"+c;n.push({id:l,fileName:c,path:x}),t[x]=this.worksheet.generate(a)}return t["xl/styles.xml"]=this.styles.generate(),t["xl/sharedStrings.xml"]=this.sharedString.generate(),t["xl/workbook.xml"]=this.generateWorkbook(e),t["[Content_Types].xml"]=re(...n.map(({path:o})=>({contentType:g.Worksheets,path:o})),{contentType:g.Workbook,path:"xl/workbook.xml"},{contentType:g.SharedStrings,path:"xl/sharedStrings.xml"},{contentType:g.Styles,path:"xl/styles.xml"}),t["xl/_rels/workbook.xml.rels"]=D(...n.map(({id:o,fileName:a})=>({id:o,type:p.Worksheet,target:"worksheets/"+a})),{id:n.length+1,type:p.SharedStrings,target:"sharedStrings.xml"},{id:n.length+2,type:p.Styles,target:"styles.xml"}),t["_rels/.rels"]=D({id:1,type:p.Workbook,target:"xl/workbook.xml"}),t}}function we(s){const e={name:s.title,rows:[]};return P({},e.rows,s),e}const d=s=>{const e=parseInt(s).toString(16);return e.length===1?"0"+e:e},M=s=>{if(s){if(s.startsWith("#"))return s;if(s.startsWith("rgba")){const[e,t,n,o]=s.replace("rgba(","").replace(")","").split(",").map(a=>a.trim());return o==="0"?void 0:"#"+d(e)+d(t)+d(n)}else if(s.startsWith("rgb")){const[e,t,n]=s.replace("rgb(","").replace(")","").split(",").map(o=>o.trim());return"#"+d(e)+d(t)+d(n)}else return}else return},w=s=>s||void 0,ke={left:"left",right:"right",start:"left",end:"right",center:"center"},ve={top:"top",bottom:"bottom",middle:"center","text-top":"top","text-bottom":"bottom"},F=s=>{const e=window.getComputedStyle(s,null),t={textAlign:ke[e.getPropertyValue("text-align")],verticalAlign:ve[e.getPropertyValue("vertical-align")],color:M(e.getPropertyValue("color")),fontFamily:e.getPropertyValue("font-family").replace(/"/g,""),fontSize:parseInt(e.getPropertyValue("font-size")),backgroundColor:M(e.getPropertyValue("background-color")),whiteSpace:e.getPropertyValue("white-space")};return{align:w(t.textAlign),alignVertical:w(t.verticalAlign),font:{color:t.color,family:w(t.fontFamily),size:w(t.fontSize)},fill:t.backgroundColor,wrap:t.whiteSpace!=="nowrap"}},k=(s,e)=>{const t=u({},s);for(const n in e)e[n]&&(typeof e[n]=="object"?t[n]=k(s[n],e[n]):t[n]=e[n]);return t},P=(s,e,t)=>{const n=k(s,F(t));for(const o of t.children)switch(o.tagName){case"THEAD":case"TBODY":case"TFOOT":P(n,e,o);break;case"TR":e.push(Ie(s,o));break}},Ie=(s,e)=>{const t=k(s,F(e));return[...e.children].filter(n=>n instanceof HTMLTableCellElement).map(n=>$e(t,n))},$e=(s,e)=>{const t=k(s,F(e)),n=e.getBoundingClientRect();return S(u({},t),{value:e.innerText,font:S(u({},t.font),{style:e.tagName==="TH"?"bold":void 0}),width:n.width,rowSpan:e.rowSpan,span:e.colSpan})};async function G(...s){const t=new be().generate(s),n=new Q;for(const[o,a]of Object.entries(t))n.file(o,oe.stringify(a));return n.generateAsync({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})}b.registerLanguage("typescript",ee);b.registerLanguage("xml",te);b.registerLanguage("css",se);b.highlightAll();var Te=document.getElementById("btn:download");const Fe={name:"TestFile",rows:[[{value:"A"},{value:"B"},{value:"C",font:{family:"Times New Roman",color:"#00FF00"},fill:"#880077"}],[{value:1},{value:2},{value:3}],[{value:"test",span:3,rowSpan:2}]]};Te.onclick=function(){console.log("generating..."),G(Fe).then(e=>{console.log("saving..."),B.exports.saveAs(e,"Workbook.xlsx"),console.log("done")}).catch(e=>console.log(String(e)))};var Ce=document.getElementById("btn:export");Ce.onclick=function(){console.log("generating..."),G(we(document.getElementById("table"))).then(s=>{console.log("saving..."),B.exports.saveAs(s,"Workbook.xlsx"),console.log("done")}).catch(s=>console.log(String(s)))};
