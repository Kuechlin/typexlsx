var Q=Object.defineProperty,ee=Object.defineProperties;var te=Object.getOwnPropertyDescriptors;var S=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable;var I=(s,e,t)=>e in s?Q(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,u=(s,e)=>{for(var t in e||(e={}))B.call(e,t)&&I(s,t,e[t]);if(S)for(var t of S(e))O.call(e,t)&&I(s,t,e[t]);return s},b=(s,e)=>ee(s,te(e));var A=(s,e)=>{var t={};for(var n in s)B.call(s,n)&&e.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&S)for(var n of S(s))e.indexOf(n)<0&&O.call(s,n)&&(t[n]=s[n]);return t};var l=(s,e,t)=>(I(s,typeof e!="symbol"?e+"":e,t),t);import{J as se,H as w,t as ne,x as oe,c as re,F as W}from"./vendor.ee0d21db.js";const ie=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerpolicy&&(i.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?i.credentials="include":o.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=t(o);fetch(o.href,i)}};ie();const g=(...s)=>({version:"1.0",encoding:"utf-8",standalone:"yes",$elements:s}),r=(s,e,...t)=>b(u({},e),{$type:"element",$name:s,$elements:t}),D=s=>({$type:"value",$value:String(s)}),N=s=>{let e="";for(const t in s)!t.startsWith("$")&&s[t]!==null&&s[t]!==void 0&&(e+=` ${t}="${String(s[t])}"`);return e},R=s=>{if(s.$type==="value")return s.$value;let e=`<${s.$name}${N(s)}`;if(s.$elements&&s.$elements.length){e+=">";for(const t of s.$elements)e+=R(t);e+=`</${s.$name}>`}else e+="/>";return e};var le={stringify(s){let e=`<?xml${N(s)}?>`;for(const t of s.$elements)e+=R(t);return e}},f;(function(s){s.Workbook="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",s.Worksheets="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",s.Styles="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",s.SharedStrings="application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"})(f||(f={}));function ae(...s){return g(r("Types",{xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"},r("Default",{Extension:"xml",ContentType:"application/xml"}),r("Default",{Extension:"rels",ContentType:"application/vnd.openxmlformats-package.relationships+xml"}),...s.map(e=>r("Override",{PartName:e.path.startsWith("/")?e.path:"/"+e.path,ContentType:e.contentType.toString()}))))}var p;(function(s){s.Workbook="http://purl.oclc.org/ooxml/officeDocument/relationships/officeDocument",s.Worksheet="http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet",s.Styles="http://purl.oclc.org/ooxml/officeDocument/relationships/styles",s.SharedStrings="http://purl.oclc.org/ooxml/officeDocument/relationships/sharedStrings"})(p||(p={}));function _(...s){return g(r("Relationships",{xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"},...s.map(({id:e,type:t,target:n})=>r("Relationship",{Id:"rId"+e,Type:t.toString(),Target:n}))))}const ce={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mx":"http://schemas.microsoft.com/office/mac/excel/2008/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","xmlns:mv":"urn:schemas-microsoft-com:mac:vml","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac","xmlns:xm":"http://schemas.microsoft.com/office/excel/2006/main"},me={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","xmlns:mv":"urn:schemas-microsoft-com:mac:vml","xmlns:mx":"http://schemas.microsoft.com/office/mac/excel/2008/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac","xmlns:xm":"http://schemas.microsoft.com/office/excel/2006/main"};function he(s){return s.replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;")}class ge{constructor(){l(this,"sharedStrings",[]);l(this,"create",e=>{e=he(e);let t=this.sharedStrings.indexOf(e);return t===-1&&(t=this.sharedStrings.push(e)-1),t});l(this,"generate",()=>g(r("sst",{xmlns:"http://purl.oclc.org/ooxml/spreadsheetml/main",count:this.sharedStrings.length,uniqueCount:this.sharedStrings.length},...this.sharedStrings.map(e=>r("si",{},r("t",{},D(e)))))))}}const fe=s=>typeof s=="object"&&("color"in s||"style"in s);function $(s){if(s[0]!=="#")throw new Error(`Color "${s}" must start with a "#"`);return`FF${s.slice("#".length).toUpperCase()}`}class pe{constructor(){l(this,"borders");l(this,"bordersIndex");l(this,"getBorderKey",e=>e?`${e.color}/${e.style}`:"-");l(this,"getBordersKey",({start:e,bottom:t,diagonal:n,end:o,top:i})=>[e,o,i,t,n].map(this.getBorderKey).join("/"));l(this,"getBorderElement",(e,t)=>{let n=t==null?void 0:t.style;return(t==null?void 0:t.color)&&!n&&(n="thin"),r(e,n?{style:n}:{},...(t==null?void 0:t.color)?[r("color",{rgb:$(t.color)})]:[])});l(this,"getBorder",e=>{if(!e)return 0;var t;fe(e)?t={start:e,end:e,top:e,bottom:e}:t=e;const n=this.getBordersKey(t);return this.bordersIndex.has(n)||this.bordersIndex.set(n,this.borders.push(t)-1),this.bordersIndex.get(n)});l(this,"generate",()=>r("borders",{count:this.borders.length},...this.borders.map(({start:e,end:t,top:n,bottom:o,diagonal:i})=>r("border",{},this.getBorderElement("start",e),this.getBorderElement("end",t),this.getBorderElement("top",n),this.getBorderElement("bottom",o),this.getBorderElement("diagonal",i)))));this.borders=[{}],this.bordersIndex=new Map([[this.getBorderKey({}),0]])}}class de{constructor(){l(this,"fills");l(this,"fillsIndex");l(this,"getFill",e=>e?(e&&!this.fillsIndex.has(e)&&this.fillsIndex.set(e,this.fills.push(e)-1),this.fillsIndex.get(e)):0);l(this,"generate",()=>r("fills",{count:this.fills.length},...this.fills.map(e=>{let t;return typeof e=="string"?t=r("patternFill",{patternType:"solid"},r("fgColor",{rgb:$(e)}),r("bgColor",{indexed:64})):typeof e=="object"&&"gray125"in e&&e.gray125?t=r("patternFill",{patternType:"gray125"}):t=r("patternFill",{patternType:"none"}),r("fill",{},t)})));this.fills=[{},{gray125:!0}],this.fillsIndex=new Map([["",0]])}}const K="Calibri",V=12,L={bold:r("b"),italic:r("i")};class ue{constructor(){l(this,"fonts");l(this,"fontsIndex");l(this,"getFontKey",({family:e=K,size:t=V,style:n="none",color:o="-"})=>`${e}/${t}/${n}/${o}`);l(this,"getFont",e=>{if(!e)return 0;const t=this.getFontKey(e);return this.fontsIndex.has(t)||this.fontsIndex.set(t,this.fonts.push(e)-1),this.fontsIndex.get(t)});l(this,"generate",()=>r("fonts",{count:this.fonts.length},...this.fonts.map(({size:e,color:t,style:n,family:o})=>r("font",{},r("sz",{val:e!=null?e:V}),r("color",t?{rgb:$(t)}:{theme:1}),r("name",{val:o!=null?o:K}),r("family",{val:2}),r("scheme",{val:"minor"}),...n&&L[n]?[L[n]]:[]))));this.fonts=[{}],this.fontsIndex=new Map([[this.getFontKey({}),0]])}}const M=100;class xe{constructor(){l(this,"formats",[]);l(this,"getFormat",e=>{if(!e)return 0;var t=this.formats.indexOf(e);return t===-1&&(t=this.formats.push(e)-1),M+t});l(this,"generate",()=>r("numFmts",{count:this.formats.length},...this.formats.map((e,t)=>r("numFmt",{numFmtId:M+t,formatCode:e}))))}}class ye{constructor(){l(this,"formats",new xe);l(this,"fonts",new ue);l(this,"fills",new de);l(this,"borders",new pe);l(this,"styles",[{formatId:0,fontId:0,fillId:0,borderId:0}]);l(this,"stylesIndex",new Map);l(this,"getStyleKey",({formatId:e,fontId:t,fillId:n,borderId:o,align:i="-",alignVertical:a="-",wrap:c})=>`${e}/${t}/${n}/${o}/${i}/${a}/${c?1:0}`);l(this,"generateCells",()=>r("cellXfs",{count:this.styles.length},...this.styles.map(this.generateCell)));l(this,"generateCell",e=>{const t=r("xf",{numFmtId:e.formatId,applyNumberFormat:e.formatId?1:void 0,fontId:e.fontId,applyFont:e.fontId?1:void 0,fillId:e.fillId,applyFill:e.fillId?1:void 0,borderId:e.borderId,applyBorder:e.borderId?1:void 0,applyAlignment:e.align||e.alignVertical||e.wrap?1:void 0});return(e.align||e.alignVertical||e.wrap)&&(t.$elements=[r("alignment",{horizontal:e.align,vertical:e.alignVertical,wrapText:e.wrap?1:void 0})]),t});l(this,"create",e=>{const t=this.formats.getFormat(e.format),n=this.fonts.getFont(e.font),o=this.fills.getFill(e.fill),i=this.borders.getBorder(e.border),a={formatId:t,fontId:n,fillId:o,borderId:i,align:e.align,alignVertical:e.alignVertical,wrap:e.wrap},c=this.getStyleKey(a);return this.stylesIndex.has(c)||this.stylesIndex.set(c,this.styles.push(a)-1),this.stylesIndex.get(c)});l(this,"generate",()=>g(r("styleSheet",{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"},this.formats.generate(),this.fonts.generate(),this.fills.generate(),this.borders.generate(),this.generateCells())))}}const Se=70*365+19,be=60*60*1e3,we=24*be;function ke(s){return s.getTime()/we+Se}function T(s,e){return`${G(s)}${e}`}const P=26;function G(s){if(typeof s!="number")return"";const e=Math.floor(s/P),t=String.fromCharCode(97+s%P).toUpperCase();return e===0?t:G(e-1)+t}class F{constructor(e){l(this,"generate",e=>{const t=F.generateMergedCells(e.rows);return g(r("worksheet",me,this.generateSheet(e.rows),...t?[t]:[]))});l(this,"generateSheet",e=>r("sheetData",{},...e.map(this.generateRow)));l(this,"generateRow",(e,t)=>{const n=t+1,o=r("row",{r:n});o.$elements=[];for(let i=0;i<e.length;i++){const a=e[i];o.$elements.push(this.generateCell(a,n,i))}return o});l(this,"generateCell",(e,t,n)=>{const o=this.workbook.styles.create(e),i=r("c",{r:T(n,t)});o!==null&&(i.s=o.toString());let a=null;if(typeof e.value=="string")i.t="s",a=this.workbook.sharedString.create(e.value);else if(typeof e.value=="boolean")i.t="s",a=e.value?1:0;else if(typeof e.value=="number")i.t="n",a=e.value;else if(e.value instanceof Date){if(!o)throw new Error('No "format" has been specified for a Date cell');i.t="n",a=ke(e.value)}return a!=null&&(i.$elements=[],i.$elements.push(r("v",{},D(a)))),i});this.workbook=e}static generateMergedCells(e){const t=[];for(let o=0;o<e.length;o++){const i=o+1,a=e[o];for(let c=0;c<a.length;c++){const n=a[c],{span:x,rowSpan:z,value:Ae}=n,J=A(n,["span","rowSpan","value"]);let m=x||1,y=z||1;if((!m||m===1)&&(!y||y===1))continue;let Y=T(c,i),q=T(c+m-1,i+y-1);t.push(r("mergeCell",{ref:`${Y}:${q}`}));for(let h=0;h<y;h++){let E=o+h;if(e.length<=E&&e.push([]),m>1||h>0&&m>0){const X=h===0?c+1:c,Z=h===0?m-1:m;e[E].splice(X,0,...new Array(Z).fill(J))}}}}return t.length===0?null:r("mergeCells",{count:t.length},...t)}}class ve{constructor(){l(this,"styles");l(this,"sharedString");l(this,"worksheet");this.styles=new ye,this.sharedString=new ge,this.worksheet=new F(this)}generateWorkbook(e){return g(r("workbook",ce,r("workbookPr"),r("sheets",{},...e.map((t,n)=>r("sheet",{name:t.name||`Table${n+1}`,sheetId:n+1,"r:id":`rId${n+1}`}))),r("definedNames"),r("calcPr")))}generate(e){const t={},n=[];for(let o=0;o<e.length;o++){const i=e[o],a=o+1,c=`sheet${a}.xml`,x="xl/worksheets/"+c;n.push({id:a,fileName:c,path:x}),t[x]=this.worksheet.generate(i)}return t["xl/styles.xml"]=this.styles.generate(),t["xl/sharedStrings.xml"]=this.sharedString.generate(),t["xl/workbook.xml"]=this.generateWorkbook(e),t["[Content_Types].xml"]=ae(...n.map(({path:o})=>({contentType:f.Worksheets,path:o})),{contentType:f.Workbook,path:"xl/workbook.xml"},{contentType:f.SharedStrings,path:"xl/sharedStrings.xml"},{contentType:f.Styles,path:"xl/styles.xml"}),t["xl/_rels/workbook.xml.rels"]=_(...n.map(({id:o,fileName:i})=>({id:o,type:p.Worksheet,target:"worksheets/"+i})),{id:n.length+1,type:p.SharedStrings,target:"sharedStrings.xml"},{id:n.length+2,type:p.Styles,target:"styles.xml"}),t["_rels/.rels"]=_({id:1,type:p.Workbook,target:"xl/workbook.xml"}),t}}function Ie(s){const e={name:s.title,rows:[]};return j({},e.rows,s),e}const d=s=>{const e=parseInt(s).toString(16);return e.length===1?"0"+e:e},H=s=>{if(s){if(s.startsWith("#"))return s;if(s.startsWith("rgba")){const[e,t,n,o]=s.replace("rgba(","").replace(")","").split(",").map(i=>i.trim());return o==="0"?void 0:"#"+d(e)+d(t)+d(n)}else if(s.startsWith("rgb")){const[e,t,n]=s.replace("rgb(","").replace(")","").split(",").map(o=>o.trim());return"#"+d(e)+d(t)+d(n)}else return}else return},k=s=>s||void 0,$e={left:"left",right:"right",start:"left",end:"right",center:"center"},Te={top:"top",bottom:"bottom",middle:"center","text-top":"top","text-bottom":"bottom"},C=s=>{const e=window.getComputedStyle(s,null),t={textAlign:$e[e.getPropertyValue("text-align")],verticalAlign:Te[e.getPropertyValue("vertical-align")],color:H(e.getPropertyValue("color")),fontFamily:e.getPropertyValue("font-family").replace(/"/g,""),fontSize:parseInt(e.getPropertyValue("font-size")),backgroundColor:H(e.getPropertyValue("background-color")),whiteSpace:e.getPropertyValue("white-space")};return{align:k(t.textAlign),alignVertical:k(t.verticalAlign),font:{color:t.color,family:k(t.fontFamily),size:k(t.fontSize)},fill:t.backgroundColor,wrap:t.whiteSpace!=="nowrap"}},v=(s,e)=>{const t=u({},s);for(const n in e)e[n]&&(typeof e[n]=="object"?t[n]=v(s[n],e[n]):t[n]=e[n]);return t},j=(s,e,t)=>{const n=v(s,C(t));for(const o of t.children)switch(o.tagName){case"THEAD":case"TBODY":case"TFOOT":j(n,e,o);break;case"TR":e.push(Fe(s,o));break}},Fe=(s,e)=>{const t=v(s,C(e));return[...e.children].filter(n=>n instanceof HTMLTableCellElement).map(n=>Ce(t,n))},Ce=(s,e)=>{const t=v(s,C(e)),n=e.getBoundingClientRect();return b(u({},t),{value:e.innerText,font:b(u({},t.font),{style:e.tagName==="TH"?"bold":void 0}),width:n.width,rowSpan:e.rowSpan,span:e.colSpan})};async function U(...s){const t=new ve().generate(s),n=new se;for(const[o,i]of Object.entries(t))n.file(o,le.stringify(i));return n.generateAsync({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})}w.registerLanguage("typescript",ne);w.registerLanguage("xml",oe);w.registerLanguage("css",re);w.highlightAll();var Ee=document.getElementById("btn:download");const Be={name:"TestFile",rows:[[{value:"A",span:2,border:{end:{color:"#000000",style:"thick"}}},{value:"B"},{value:"C",font:{family:"Times New Roman",color:"#00FF00"},fill:"#880077"}],[{value:1},{value:2},{value:3}],[{value:"test",span:3,rowSpan:2}]]};Ee.onclick=function(){console.log("generating..."),U(Be).then(e=>{console.log("saving..."),W.exports.saveAs(e,"Workbook.xlsx"),console.log("done")}).catch(e=>console.log(String(e)))};var Oe=document.getElementById("btn:export");Oe.onclick=function(){console.log("generating..."),U(Ie(document.getElementById("table"))).then(s=>{console.log("saving..."),W.exports.saveAs(s,"Workbook.xlsx"),console.log("done")}).catch(s=>console.log(String(s)))};
